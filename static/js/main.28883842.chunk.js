(this.webpackJsonpchatapp=this.webpackJsonpchatapp||[]).push([[0],{108:function(e,t){},141:function(e,t){},143:function(e,t){},157:function(e,t,n){"use strict";n.r(t);var o=n(0),a=n.n(o),s=n(23),i=n.n(s),c=(n(79),n(1)),r=n(7),l=n(8),u=n(9),d=function e(){var t=this;Object(c.a)(this,e),this._id=1e5*Math.random()*Math.random(),this.localId=1e5*Math.random()*Math.random(),this.from="",this.to="",this.body="",this.chatId="",this.status=e.SENDING,this.sentTimeDate=Date.now(),this.seenTimeDate=null,this.messageType=e.TEXT,this.chatType="single",this.seenAckCount=0,this.recievedAckCount=0,this.setAttributes=function(e,n,o){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return t.from=e,t.to=n,t.body=o,t.chatId=a,t},this.setValue=function(e){return t._id=e._id,t.from=e.from,t.to=e.to,t.body=e.body,t.status=e.status,t.type=e.type,e.chatId&&(t.chatId=e.chatId),t},this.setAsGroupMessage=function(){return t.chatType="group",t}};d.TEXT="TEXT",d.VIDEO="VIDEO",d.IMAGE="IMAGE",d.SENDING=0,d.SENT=1,d.RECIEVED=2,d.SEEN=3;var h=d,g=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(c.a)(this,n);for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).state={},e}return Object(r.a)(n,[{key:"render",value:function(){var e=this.props.message?this.props.message:(new h).setAttributes("","a","abasdfasdf asdfasdfasdfs dfasdfasdfasdf asdfasdfasdfasd fasdfasdfasd fasdfasdfc dedfsadf"),t=this.props.cid===e.from,n=t?"#F2F3F8":"#5BBC93",o=t?"#5BBC93":"#F2F3F8",s=t?"right":"left";return a.a.createElement("div",{style:{width:"100%",float:"left"}},"IMAGE"===e.type?a.a.createElement("img",{width:"100px",height:"100px",src:e.body}):a.a.createElement("div",{style:{display:"block",minWidth:"40%",maxWidth:"70%",float:s,backgroundColor:n,padding:10,marginTop:5}},a.a.createElement("span",{style:{color:o}}," ",e.body),a.a.createElement("span",{style:{float:"right",color:"red"}},e.status+"] "+new Date(e.sentTimeDate).toLocaleTimeString()," o")))}}]),n}(o.Component),E=n(24),C=n(71),f=n.n(C),m=function e(t,n,o){Object(c.a)(this,e),this.type=t,this.payload=n,this.to=o},p=function e(){Object(c.a)(this,e)};p.CALLING=0,p.RUNNING=1,p.ACCEPTED=2,p.CONNECTING=3,p.CONNECTED=4,p.ON_ANOTHER_CALL=5,p.DECLINED=6;var S=function e(t,n){var o=this;Object(c.a)(this,e),this.setChannelEnabled=function(e,t){var n=(o.localStream.getTracks()||[]).findIndex((function(t){return t.kind===e}));n>=0&&(o.localStream.getTracks()[n].enabled=t)},this.handleCommunication=function(){o.socket.on("onRecieveRTCMessage",(function(e){if(o.peerConnection){var t=e.query;switch(t.type){case"OFFER":console.log("STEP-1: RECIEVE OFFER"),console.log(t),console.log("---Adding offer to peer connection"),o.peerConnection.setRemoteDescription(new RTCSessionDescription(t.payload)).then((function(){console.log("---added remote offer"),o.recieveCall()})).catch((function(e){console.log("CATCH- error in setting remote offer"),console.log(e)}));break;case"ANSWER":console.log("STEP-4: ANSER RECIEVED"),o.peerConnection.setRemoteDescription(new RTCSessionDescription(t.payload)).then((function(){console.log("---added remote answer")})).catch((function(e){console.log("CATCH- error in setting remote answer"),console.log(e)}));break;case"CALLER_ICE":o.peerConnection.addIceCandidate(new RTCIceCandidate(t.payload)).then((function(){console.log("++++++++ICE ADDED: RECIEVER")})).catch((function(e){console.log("CATCH- error in setting remote Reciever ice candidate"),console.log(e)}));break;case"RECIEVER_ICE":console.log("++++++++ICE ADDED"),o.peerConnection.addIceCandidate(new RTCIceCandidate(t.payload)).then((function(){console.log("++++++++ICE ADDED: CALLER")})).catch((function(e){console.log("CATCH- error in setting remote Caller ice candidate"),console.log(e)}))}}else console.log("PEER CONNECTION NOT INITIALIZED")}))},this.createConnection=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;o.myId=e,o.peerId=t,null!==n&&(o.configuration=n),console.log("CONFIGS"),console.log(o.configuration),o.peerConnection=new RTCPeerConnection(o.configuration),o.peerConnection.onicecandidate=function(e){e.candidate&&(o.callerId?o.sendMessage(new m("CALLER_ICE",e.candidate,o.peerId)):o.sendMessage(new m("RECIEVER_ICE",e.candidate,o.peerId)))},o.peerConnection.onaddstream=function(e){console.log("Streaming...!!!"),console.log(e.stream),o.context.handelOnAddRemoteStream(e.stream),o.peerStream=e.stream},o.peerConnection.oniceconnectionstatechange=function(e){switch(console.info("ICE Connection State Changed:",e.target.iceConnectionState),e.target.iceConnectionState){case"closed":case"disconnected":case"failed":console.log("FAILD, Disconnected OR closed")}}},this.destroyConnection=function(){o.localStream&&o.localStream.getTracks().forEach((function(e){e.stop()})),o.peerConnection&&(o.peerConnection.close(),o.peerConnection=null,o.localStream=null,o.peerStream=null,o.peerId=null)},this.startCall=function(e){!(arguments.length>1&&void 0!==arguments[1])||arguments[1];o.callerId=!0,console.log("STEP-1: Turning On Cam");navigator.mediaDevices?(navigator.mediaDevices.enumerateDevices().then((function(t){console.log("Source Infos"),console.log(t);for(var n=0;n<t.length;n++){var o=t[n];"videoinput"==o.kind&&o.facing==(e?"front":"back")&&o.deviceId}})),navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0},video:!0}).then((function(e){o.localStream=e,o.context.handelOnAddLocalStream(e),console.log("STEP-2: ADDING STREAM TO PEER CONNECTION"),o.peerConnection.addStream(o.localStream),console.log(e),console.log("STEP-3: CREATING OFFER"),o.peerConnection.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0}).then((function(e){o.sendMessage(new m("OFFER",e,o.peerId)),o.peerConnection.setLocalDescription(e).then((function(){console.log("---Offer- locally added")})).catch((function(e){console.log("CATCH-error in adding offer")}))})).catch((function(e){console.log("CATCH- error in creating offer"),console.log(e)}))}))):alert("no video source")},this.recieveCall=function(){o.callerId=!1;navigator.mediaDevices.enumerateDevices().then((function(e){console.log("Source Infos"),console.log(e);for(var t=0;t<e.length;t++){var n=e[t];"videoinput"==n.kind&&"front"==n.facing&&n.deviceId}})),navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0},video:!0}).then((function(e){o.localStream=e,o.context.handelOnAddLocalStream(e),console.log("STEP-2: ADDING STREAM TO PEER CONNECTION"),o.peerConnection.addStream(o.localStream),console.log("STEP-3: CREATING ANSWER"),o.peerConnection.createAnswer({offerToReceiveAudio:!0,offerToReceiveVideo:!0}).then((function(e){console.log(e),o.sendMessage(new m("ANSWER",e,o.peerId)),console.log("---adding answer to description"),o.peerConnection.setLocalDescription(e).then((function(){console.log("---answer added locally")})).catch((function(e){console.log("CATCH- error in adding answer locally"),console.log(e)}))})).catch((function(e){console.log("CATCH-error in creating answer"),console.log(e)}))}))},this.sendMessage=function(e){console.log("---Sending message of type: "+e.type),console.log(e),o.socket.emit("onSendRTCMessage",{query:e})},this.getStream=function(){return o.localStream},this.socket=n,this.myId=null,this.peerId=null,this.localStream=null,this.peerStream=null,this.context=t,this.configuration={iceServers:[{url:"stun:stun.l.google.com:19302"},{urls:"turn:numb.viagenie.ca",username:"ata.mirza40@gmail.com",credential:"ataMirza12345_"}]},this.peerConnection=null,this.handleCommunication()},A=function e(){Object(c.a)(this,e)};A.RINGING_REQUEST=0,A.RINGING=2,A.ACCEPTED=3,A.REJECTED=4,A.USEROFFLINE=5,A.USERONLINE=6,A.ON_OHTER_CALL=7;var y=A,T=function e(t,n,o){Object(c.a)(this,e),this.type=t,this.to=n,this.from=o},_=function e(t,n){var o=this;Object(c.a)(this,e),this.handelSingnaling=function(){o.socket.on("onListen",(function(e){var t=e.query;switch(t.type){case y.RINGING_REQUEST:o.isBusy?o.socket.emit("onCommunicate",{query:new T(y.ON_OHTER_CALL,t.from,o.context.cid)}):(o.isBusy=!0,o.context.handelOnAddCallStatus(y.RINGING_REQUEST),o.peerId=t.from,console.log("INCOMMING CALL: RING REQUEST"),console.log("CREATING RTC CONNECTION: RECIVER"),o.context.createRTCConnection(t.from),o.socket.emit("onCommunicate",{query:new T(y.RINGING,t.from,o.context.cid)}));break;case y.RINGING:o.isBusy=!0,o.context.handelOnAddCallStatus(y.RINGING),console.log("CALL: RINGING...");break;case y.ACCEPTED:o.isBusy=!0,o.context.handelOnAddCallStatus(y.ACCEPTED),console.log("CALL: ACCEPTED"),o.context.startRTCCall(!0);break;case y.REJECTED:o.isBusy=!1,o.context.handelOnAddCallStatus(y.REJECTED),o.context.destroyRTCConnection();break;case y.ON_OHTER_CALL:o.isBusy=!1,o.context.handelOnAddCallStatus(y.ON_OHTER_CALL),o.context.destroyRTCConnection()}}))},this.connetingPeer=function(){console.log("Connecting..."),o.context.handelOnAddCallStatus(y.RINGING),o.socket.emit("onCommunicate",{query:new T(y.RINGING_REQUEST,o.peerId,o.context.cid)},(function(e){e.type===y.USEROFFLINE?(console.log("PEER OFFLINE: RECONNECTING"),o.connetingPeer(o.peerId)):console.log("PEER: ONLINE")}))},this.initializeSingnaling=function(e){return o.peerId=e,o.isBusy=!0,console.log("STEP1: initializing signaling"),new Promise((function(t,n){o.context.socketConnected?(console.log("Me: CONNECTED"),console.log("CREATING RTC CONNECTION: CALLER"),o.context.createRTCConnection(e),o.connetingPeer(e),t(!0)):(console.log("Me: NOT CONNECTED"),n(!1))}))},this.acceptSignaling=function(){return o.isBusy=!0,new Promise((function(e,t){o.socket.emit("onCommunicate",{query:new T(y.ACCEPTED,o.peerId,o.context.cid)},(function(n){n.type===y.USERONLINE?e(!0):t(!1)}))}))},this.endCallSingnal=function(e){o.socket.emit("onCommunicate",{query:new T(y.REJECTED,o.peerId,o.context.cid)}),o.context.handelOnAddCallStatus(y.REJECTED),o.isBusy=!1,o.peerId=null},this.socket=t,this.context=n,this.peerId=null,this.isBusy=!1,this.handelSingnaling()},I=n(10),N=n(5),O=function e(){var t=this;Object(c.a)(this,e),this._id="",this.username="",this.phoneNumber="",this.setAttributes=function(e,n){return t._id=e,t.username=n,t},this.setValue=function(e){return t._id=e._id,t.username=e.username,t.phoneNumber=e.phoneNumber,t}},v=function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{_id:"",username:""};Object(c.a)(this,e),this._id="",this.cid=n._id,this.title=n.username,this.user=n,this.messages=[],this.selected=!1,this.unseenCount=0,this.lastMessage=new h,this.chatType="single",this.chatStatus=e.CHAT_NOT_FOUND,this.setAttributes=function(e,o){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return t.user=n,t.cid=n._id,t.title=n.username,t.messages=e,t.selected=o,t.unseenCount=a,t},this.compose=function(e,n){return t.cid=e.cid,t.title=e.title,t.user=e.user,n.chat&&(t._id=n.chat._id,t.messages=n.chat.messages,t.chatStatus=n.chatStatus,t.unseenCount=n.unseenCount,t.messages.length>0&&(t.lastMessage=(new h).setValue(t.messages[t.messages.length-1]))),console.log("VALUE"),console.log(t),t},this.setValue=function(e){return t.cid=e._id,t.user=e.user,t.messages=e.chat,t.selected=!1,t.unseenCount=0,t},this.setChat=function(e){return e?(t.cid=e._id,t.messages=e.chat,t.title=e.title,t.selected=!1,t.unseenCount=0):(t.cid="",t.messages=[],t.selected=!1,t.unseenCount=0),t},this.setUser=function(e){return t.user=(new O).setValue(e),t}};v.USER_NOT_FOUND=0,v.CHAT_NOT_FOUND=1,v.USER_CHAT_FOUND=2;var R=v,b=function e(t){var n=this;Object(c.a)(this,e),this._id=t,this.cid=t,this.title="Group Chat",this.users=[],this.messages=[],this.selected=!1,this.unseenCount=0,this.lastMessage=new h,this.chatType="group",this.chatStatus=2,this.setAttributes=function(e,t,o){return setTimeout((function(){return le(n.cid)}),500),n.users=e,n.messages=t,n.selected=o,n},this.setValue=function(e){return setTimeout((function(){return le(n.cid)}),500),n.users=e.users,n.messages=e.messages,n.selected=e.selected,n.unseenCount=e.unseenCount,n}},M={Chat:[],user:{_id:"",username:""}},D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(I.a)({},M),t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CHAT_LIST_CM":return console.log(t.payload.chat),e.Chat=t.payload.chat,localStorage.setItem("userchatxyz1010",JSON.stringify(e)),w(e);case"USER_CHAT_DATA_COLLECTOR":var n=t.payload.message,o="group"===n.chatType?n.to:n.from;if(n.from!==e.user._id){console.log("=========user data collection========"),console.log(n);var a=e.Chat.findIndex((function(e){return e.cid===o}));a>=0?(e.Chat[a].messages.push(n),e.Chat[a].lastMessage=n,e.Chat.sort((function(e,t){return t.lastMessage.sentTimeDate-e.lastMessage.sentTimeDate}))):(console.log("Undefined user message"),console.log(n))}return e.Chat.sort((function(e,t){return t.lastMessage.sentTimeDate-e.lastMessage.sentTimeDate})),localStorage.setItem("userchatxyz1010",JSON.stringify(e)),w(e);case"GROUP_CHAT_DATA_HANDLER":var s=t.payload.message,i=s.chatId;if(s.from!==e.user._id){console.log("=========group data collection========"),console.log(s);var c=e.Chat.findIndex((function(e){return e.cid===i}));c>=0?(e.Chat[c].messages.push(s),e.Chat[c].lastMessage=s,e.Chat.sort((function(e,t){return t.lastMessage.sentTimeDate-e.lastMessage.sentTimeDate}))):(console.log("Undefined user message"),console.log(s))}return e.Chat.sort((function(e,t){return t.lastMessage.sentTimeDate-e.lastMessage.sentTimeDate})),localStorage.setItem("userchatxyz1010",JSON.stringify(e)),w(e);case"GROUP_MESSAGE_ACK_ACTION":var r=t.payload.message,l=t.payload.status;console.log("01---MSG"),console.log(r);var u=e.Chat.findIndex((function(e){return e.cid===r.chatId}));if(u>=0){var d=-1;if(r.isNewId?(console.log("02---isNew"),d=e.Chat[u].messages.findIndex((function(e){return e.localId==r.localId})),console.log(d)):(console.log("02---"),d=e.Chat[u].messages.findIndex((function(e){return e._id==r._id})),console.log(d)),d>=0){switch(l){case h.SEEN:e.Chat[u].messages[d].seenAckCount++,e.Chat[u].messages[d].seenAckCount>=e.Chat[u].messages[d].users.length-1&&(e.Chat[u].messages[d].status=h.SEEN);break;case h.RECIEVED:e.Chat[u].messages[d].recievedAckCount++,e.Chat[u].messages[d].status=h.RECIEVED}r.isNewId&&(e.Chat[u].messages[d]._id=r.isNewId,console.log("NEW ID MSG"))}else console.log("MSG NOT FOUND")}else console.log("CHAT NOT FOUND");return localStorage.setItem("userchatxyz1010",JSON.stringify(e)),w(e);case"INITIALIZE_CHAT_BETWEEN_CM":var g=t.payload,E=g.friend,C=g.chat,f=e.Chat.findIndex((function(e){return e.cid===E._id}));return f>=0&&(e.Chat[f]._id=C._id,e.Chat[f].chatStatus=R.USER_CHAT_FOUND),localStorage.setItem("userchatxyz1010",JSON.stringify(e)),w(e);case"USER_CHAT_SENT_DATA_COLLECTOR":console.log("=========send data collection========");var m=t.payload.message;console.log(m);var p=e.Chat.findIndex((function(e){return e.cid===m.to}));return p>=0?(e.Chat[p].messages.push(m),e.Chat[p].lastMessage=m,e.Chat.sort((function(e,t){return t.lastMessage.sentTimeDate-e.lastMessage.sentTimeDate}))):(console.log("Undefined user message"),console.log(m)),localStorage.setItem("userchatxyz1010",JSON.stringify(e)),w(e);case"USER_CHAT_HANDLE_SELECTD":for(var S=t.payload.cid,A=0;A<e.Chat.length;A++)e.Chat[A].cid===S?e.Chat[A].selected=!0:e.Chat[A].selected=!1;return localStorage.setItem("userchatxyz1010",JSON.stringify(e)),w(e);case"HANDLE_REMOVE_CHAT":return e.Chat=e.Chat.filter((function(e){return e.cid!==t.payload.cid})),e.Chat.sort((function(e,t){return t.lastMessage.sentTimeDate-e.lastMessage.sentTimeDate})),localStorage.setItem("userchatxyz1010",JSON.stringify(e)),w(e);case"MSG_ACK_ACTION":var y=t.payload.message,T=t.payload.status;console.log("01---MSG"),console.log(y);var _=e.Chat.findIndex((function(t){return t.cid===(y.to===e.user._id?y.from:y.to)}));if(_>=0){var N=-1;y.isNewId?(console.log("02---isNew"),N=e.Chat[_].messages.findIndex((function(e){return e.localId==y.localId})),console.log(N)):(console.log("02---"),N=e.Chat[_].messages.findIndex((function(e){return e._id==y._id})),console.log(N)),N>=0?(e.Chat[_].messages[N].status=T,y.isNewId&&(e.Chat[_].messages[N]._id=y.isNewId)):console.log("MSG NOT FOUND")}else console.log("CHAT NOT FOUND");return localStorage.setItem("userchatxyz1010",JSON.stringify(e)),w(e);case"MSGS_ACK_ACTION":var O=t.payload.messages,v=t.payload.status,b=t.payload.cid,D=e.Chat.findIndex((function(e){return e.cid===b})),k=0;if(D>=0)for(var P=e.Chat[D].messages.length-1;P>=0;P--){for(var U=e.Chat[D].messages[P],G=0;G<O.length;G++){var L=O[G];if(L._id===U._id){e.Chat[D].messages[P].status=v,k++;break}}if(k>=O.length)break}return localStorage.setItem("userchatxyz1010",JSON.stringify(e)),w(e);case"SET_USER":return e.user=t.payload.user,localStorage.setItem("userchatxyz1010",JSON.stringify(e)),w(e);case"LOGOUT":return localStorage.removeItem("userchatxyz1010"),{Chat:[],user:{_id:"",username:""}};default:var x=localStorage.getItem("userchatxyz1010");return x?x=JSON.parse(x):w(e)}},w=function(e){return JSON.parse(JSON.stringify(e))},k={user:{_id:"",username:""}},P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(I.a)({},k),t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USER":return e.user=t.payload.user,localStorage.setItem("userauth1010",JSON.stringify(e)),U(e);case"LOGOUT":return localStorage.removeItem("userauth1010"),{user:{_id:"",username:""}};default:var n=localStorage.getItem("userauth1010");return n?JSON.parse(n):U(e)}},U=function(e){return JSON.parse(JSON.stringify(e))},G=function e(t){var n=this;Object(c.a)(this,e),this._id="",this.users=[],1===t.length?this.to=t[0]:this.users=t,this.localId=1e5*Math.random()*Math.random(),this.pushType=0,this.payload=null,this.status=e.ACTION_STATUS_NEW,this.setAttributes=function(e,t,o,a){return n._id=e,n.localId=e,n.pushType=t,n.payload=o,n.status=a,n}};G.TEXT_MESSAGE=1,G.IMAGE_MESSAGE=2,G.VIDEO_MESSAGE=3,G.CALL=5,G.ACTION_STATUS_NEW=1,G.ACTION_STATUS_MARKED=2,G.ACTION_STATUS_SUSPENDED=3,G.SETVER_ACTION_REMOVE_PUSHES=6,G.SETVER_ACTION_REMOVE_PUSH=10,G.USER_NEW_PUSH_ACTION=7,G.MESSAGE=8,G.ACK_MESSAGE=9,G.GROUP_MESSAGE=20,G.ACK_GROUP_MESSAGE=21;var L=G,x={incPushActions:[],outPushActions:[]},H=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(I.a)({},x),t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOAD_ALL_PUSHES":for(var n=t.payload.pushActions,o=function(t){var o=n[t];e.incPushActions.findIndex((function(e){return e._id===o._id}))>=0?console.log("already exist"):e.incPushActions.push(new L([]).setAttributes(o._id,o.pushType,o.payload,L.ACTION_STATUS_NEW))},a=0;a<n.length;a++)o(a);return localStorage.setItem("pushaction1010",JSON.stringify(e)),V(e);case"SET_INC_PUSH_STATUS":var s=t.payload,i=s._id,c=s.status,r=e.incPushActions.findIndex((function(e){return e._id===i}));return r>=0&&(e.incPushActions[r].status=c),localStorage.setItem("pushaction1010",JSON.stringify(e)),V(e);case"REMOVE_INC_PUSH_ACTIONS":return t.payload.pushActions.forEach((function(t){t.removed?e.incPushActions=e.incPushActions.filter((function(e){return e._id!==t._id})):(console.log("NOT REMOVED"),console.log(t))})),localStorage.setItem("pushaction1010",JSON.stringify(e)),V(e);case"ADD_OUT_PUSH_ACTION":return console.log("PUSHING LOCALLY ...."),e.outPushActions.push(t.payload.pushAction),localStorage.setItem("pushaction1010",JSON.stringify(e)),V(e);case"REMOVE_OUT_PUSH_ACTION":return e.outPushActions=e.outPushActions.filter((function(e){return e.localId!==t.payload.pushAction.localId})),localStorage.setItem("pushaction1010",JSON.stringify(e)),V(e);case"UPDATE_OUT_PUSH_ID":var l=t.payload._id,u=t.payload.localId,d=e.outPushActions.findIndex((function(e){return e.localId===u}));return r>=0&&(e.outPushActions[d]._id=l),localStorage.setItem("pushaction1010",JSON.stringify(e)),V(e);case"LOGOUT":return localStorage.removeItem("pushaction1010"),{incPushActions:[],outPushActions:[]};default:var h=localStorage.getItem("pushaction1010");return h?h=JSON.parse(h):V(e)}},V=function(e){return JSON.parse(JSON.stringify(e))},j=Object(N.c)({ChatReducer:D,AuthReducer:P,PushesReducer:H}),z=[n(73).a],F={},B=window.__REDUX_DEVTOOLS_EXTENSION__?Object(N.e)(j,F,Object(N.d)(N.a.apply(void 0,z),window.__REDUX_DEVTOOLS_EXTENSION__())):Object(N.e)(j,F,Object(N.d)(N.a.apply(void 0,z))),J=n(11),K=n.n(J),W="https://niofoxvideochatserver.herokuapp.com/",q=function(e){switch(e.pushType){case L.MESSAGE:e.payload._id=e._id,B.dispatch({type:"USER_CHAT_DATA_COLLECTOR",payload:{message:e.payload}});break;case L.ACK_MESSAGE:B.dispatch({type:"MSG_ACK_ACTION",payload:{message:e.payload,status:e.payload.status}});break;case L.GROUP_MESSAGE:e.payload._id=e._id,B.dispatch({type:"GROUP_CHAT_DATA_HANDLER",payload:{message:e.payload}});break;case L.ACK_GROUP_MESSAGE:B.dispatch({type:"GROUP_MESSAGE_ACK_ACTION",payload:{message:e.payload,status:e.payload.status}})}},X=function e(t,n,o){var a=this;Object(c.a)(this,e),this.cid=t,this.socket=n,this.communicatorContext=o,this.socket.on("onListenPushCommunicator",(function(e){var t=e.query;switch(q(t),a.ackRemotePush(t),t.pushType){case L.MESSAGE:a.sendPushAction(L.ACK_MESSAGE,{_id:t.payload._id,to:t.payload.to,from:t.payload.from,status:h.RECIEVED},t.payload.from)}})),this.socket.on("onListenGroupPushCommunicator",(function(e){var t=e.query;switch(q(t),a.ackRemotePush(t),t.pushType){case L.GROUP_MESSAGE:t.payload._id=t._id,a.sendPushGroupAction(L.ACK_GROUP_MESSAGE,{_id:t.payload._id,chatId:t.payload.chatId,from:t.payload.from,status:h.RECIEVED},t.users)}})),this.loadPushes=function(){a.getAllPushes().then((function(e){for(var t=B.getState().PushesReducer.incPushActions.filter((function(e){return e.status===L.ACTION_STATUS_NEW})),n=0;n<t.length;n++){var o=t[n];switch(q(o),o.pushType){case L.MESSAGE:a.sendPushAction(L.ACK_MESSAGE,{_id:o.payload._id,to:o.payload.to,from:o.payload.from,status:h.RECIEVED},o.payload.from)}a.markPushAction(o._id,L.ACTION_STATUS_MARKED)}var s=B.getState().PushesReducer.incPushActions.filter((function(e){return e.status===L.ACTION_STATUS_MARKED}));a.pushAckAndRemove(s)})).catch((function(e){console.log("CATCH: LOAD PUSHED"),console.log(e)}))},this.getAllPushes=function(){return new Promise((function(e,t){K.a.post(W+"/API/user/chat/get-pushes",{userId:a.cid}).then((function(t){B.dispatch({type:"LOAD_ALL_PUSHES",payload:{pushActions:t.data}}),e(!0)})).catch((function(e){console.log("CATCH: NETWORK ERROR"),console.log(e),t(!1)}))}))},this.dispatchIncPushAction=function(e){switch(e.pushType){case L.TEXT_MESSAGE:var t=Object(I.a)({},e);t.payload._id=e._id,B.dispatch({type:"USER_CHAT_DATA_COLLECTOR",payload:{message:t.payload}}),a.pushRemote({message:t.payload,cid:t.payload.from,status:h.RECIEVED},L.ACK_MESSAGE);break;case L.ACK_MESSAGE:var n=e.payload;B.dispatch({type:"MSGS_ACK_ACTION",payload:{messages:n.messages,cid:n.cid,status:n.status}})}},this.markPushAction=function(e,t){B.dispatch({type:"SET_INC_PUSH_STATUS",payload:{_id:e,status:t}})},this.pushAck=function(e){},this.pushAckAndRemove=function(e){a.socket.emit("onPushCommunicator",{query:{payload:e,pushType:L.SETVER_ACTION_REMOVE_PUSHES}},(function(e){B.dispatch({type:"REMOVE_INC_PUSH_ACTIONS",payload:{pushActions:e}})}))},this.ackRemotePush=function(e){a.socket.emit("onPushCommunicator",{query:{payload:{_id:e._id},pushType:L.SETVER_ACTION_REMOVE_PUSH}},(function(e){}))},this.pushRemote=function(e,t){a.socket.emit("onPushCommunicator",{query:{payload:e,type:t}},(function(e){}))},this.pushLocalAction=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:L.ACTION_STATUS_NEW;B.dispatch({type:"ADD_OUT_PUSH_ACTION",payload:{pushAction:new L([""]).setAttributes(1e3*Math.random()*Math.random(),e,t,n)}})},this.pushLocally=function(e){B.dispatch({type:"ADD_OUT_PUSH_ACTION",payload:{pushAction:e}})},this.onNetworkConnected=function(){B.getState().PushesReducer.outPushActions.forEach((function(e){a.dispatchOutAction(e)}))},this.dispatchOutAction=function(e){switch(console.log("ACTION DISPATCH"),console.log(e),e.pushType){case L.TEXT_MESSAGE:console.log("SENDING ..."),a.communicatorContext.send(e.payload.message,e.payload.chatId,e)}},this.removeOutPushAction=function(e){B.dispatch({type:"REMOVE_OUT_PUSH_ACTION",payload:{pushAction:e}})},this.emitPush=function(e){a.socket.emit("onPushActionCommunicator",{query:e},(function(e){switch(a.removeOutPushAction(e),console.log("EMIT PUSH ACK: "),console.log(e),e.pushType){case L.MESSAGE:e.pushType=L.ACK_MESSAGE,e.payload.isNewId=e._id,e.payload.status=h.SENT,console.log("ACK SENDING >>>"),console.log(e),q(e)}}))},this.emitGroupPush=function(e){a.socket.emit("onPushGroupActionCommunicator",{query:e},(function(e){switch(a.removeOutPushAction(e),console.log("EMIT PUSH ACK: "),console.log(e),e.pushType){case L.GROUP_MESSAGE:e.pushType=L.ACK_GROUP_MESSAGE,e.payload.isNewId=e._id,e.payload.status=h.SENT,console.log("ACK SENDING >>>"),console.log(e),q(e)}}))},this.sendPushAction=function(e,t,n){if(a.communicatorContext.socketConnected){var o=new L([n]).setAttributes(1e3*Math.random()*Math.random(),e,t,L.ACTION_STATUS_SUSPENDED);a.pushLocally(o),q(o),a.emitPush(o)}else{var s=new L([n]).setAttributes(1e3*Math.random()*Math.random(),e,t,L.ACTION_STATUS_NEW);a.pushLocally(s),q(s)}},this.sendPushGroupAction=function(e,t,n){if(a.communicatorContext.socketConnected){var o=new L(n).setAttributes(1e3*Math.random()*Math.random(),e,t,L.ACTION_STATUS_SUSPENDED);a.pushLocally(o),q(o),a.emitGroupPush(o)}else{var s=new L(n).setAttributes(1e3*Math.random()*Math.random(),e,t,L.ACTION_STATUS_NEW);a.pushLocally(s),q(s)}}},Q=function e(){var t=this;Object(c.a)(this,e),this.socket=null,this.dataHandler=null,this.ackEmitter=null,this.ackEmitters=null,this.onConnectEmitter=null,this.onDisconnectEmitter=null,this.cid=null,this.socketConnected=!1,this.rtcConfig={iceServers:[{url:"stun:stun.l.google.com:19302"},{urls:"turn:turn.msgsafe.io:443?transport=tcp",username:"a9a2b514",credential:"00163e7826d6"}]},this.callSignalingManager=!1,this.videoChatContext=null,this.rtcConnectionManager=null,this.pushActionsManager=null,this.connect=function(e,n,o,a){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;t.cid=e,t.dataHandler=n,t.ackEmitter=o,t.ackEmitters=a,t.onConnectEmitter=s,t.onDisconnectEmitter=i,t.socket=f()(W,{query:{cid:e}}),t.rtcConnectionManager=new S(t,t.socket),t.callSignalingManager=new _(t.socket,t),t.pushActionsManager=new X(t.cid,t.socket,t),t.send=function(e){t.pushActionsManager.sendPushAction(L.MESSAGE,e,e.to)},t.sendGroupMessage=function(e,n){t.pushActionsManager.sendPushGroupAction(L.GROUP_MESSAGE,e,n)},t.markSeen=function(e,n){arguments.length>2&&void 0!==arguments[2]&&arguments[2],arguments.length>3&&void 0!==arguments[3]&&arguments[3];console.log("MARK SEEN: "),e.length>0&&e.forEach((function(e){t.pushActionsManager.sendPushAction(L.ACK_MESSAGE,{_id:e._id,from:e.to,to:e.from,status:h.SEEN},n)}))},t.markSeenGroupMessage=function(e,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];console.log("MARK SEEN: "),e.length>0&&(console.log("GROUP:"),e.forEach((function(e){t.pushActionsManager.sendPushGroupAction(L.ACK_GROUP_MESSAGE,{_id:e._id,from:e.to,to:e.from,chatId:o,status:h.SEEN},a)})))},t.dataRouter=function(e){},t.ackRouter=function(e){},t.socket.on("connect",(function(){console.log("STATUS: CONNECTED"),t.pushActionsManager.loadPushes(),t.socketConnected=!0,t.pushActionsManager.onNetworkConnected(),t.onConnectEmitter&&t.onConnectEmitter()})),t.socket.on("connect_error",(function(e){console.log("CONNECT: ERROR"),t.onDisconnectEmitter&&t.onDisconnectEmitter(),t.socketConnected=!1,console.log(e)})),t.socket.on("connect_timeout",(function(e){console.log("CONNECT: TIMEOUT"),console.log(e),t.socketConnected=!1})),t.socket.on("disconnect",(function(e){t.onDisconnectEmitter&&t.onDisconnectEmitter(),t.socketConnected=!1,"io server disconnect"===e&&t.socket.connect()})),t.socket.on("reconnect",(function(e){console.log("SOCKET: RECONNECTED"),console.log(e),t.socketConnected=!1})),t.socket.on("reconnect_attempt",(function(e){console.log("RECONNECT ATTEMPTS"),t.socketConnected=!1,console.log(e)})),t.socket.on("reconnecting",(function(e){console.log("RECONNECTING..."),t.socketConnected=!1})),t.socket.on("reconnect_error",(function(e){console.log("RECONNECT ERROR"),t.socketConnected=!1}))},this.initializeSignaling=function(e){t.callSignalingManager.initializeSingnaling(e)},this.acceptCall=function(){t.callSignalingManager.acceptSignaling()},this.setChatContext=function(e){t.videoChatContext=e},this.endCallSignal=function(){t.callSignalingManager.endCallSingnal()},this.createRTCConnection=function(e){t.rtcConnectionManager.createConnection(t.cid,e,t.rtcConfig)},this.startRTCCall=function(e){t.rtcConnectionManager.startCall(e)},this.setRTCChannelEnabled=function(e,n){t.rtcConnectionManager.setChannelEnabled(e,n)},this.destroyRTCConnection=function(){t.rtcConnectionManager.destroyConnection()},this.handelOnAddRemoteStream=function(e){t.videoChatContext.setState({peerStream:e})},this.handelOnAddLocalStream=function(e){t.videoChatContext.setState({localStream:e})},this.handelOnAddCallStatus=function(e){console.log("CALL STATUS "+e),t.videoChatContext.setState({callStatus:e})}},Y=new Q,Z=[],$=function(){K.a.post("http://localhost:5000/API/user/auth/get-all").then((function(e){if(e.data.success){for(var t=e.data.users,n=[],o=0;o<t.length;o++){var a=t[o];n.push(new R((new O).setValue(a)).setAttributes([],!1))}B.dispatch({type:"SET_CHAT_LIST_CM",payload:{chat:n}})}else console.log("ERROR SUCCESS:FALSE"),console.log(e.data.error)})).catch((function(e){console.log("CATCH: API, NETWORK ERROR"),console.log(e)}))},ee=function(e){K.a.post("http://localhost:5000/API/user/chat/user-chat",{userId:e}).then((function(e){if(e.data.success){for(var t=e.data.user.userChat,n=Object(E.a)(B.getState().ChatReducer.Chat),o=[],a=0;a<t.length;a++){for(var s=t[a],i=!1,c=0;c<n.length;c++){var r=n[c];if(r.cid===s.cid){i=!0,r._id=s._id,r.messages=s.messages,r.chatStatus=R.USER_CHAT_FOUND,o.push(r);break}}i||(s.chatStatus=R.USER_CHAT_FOUND,"group"===s.chatType&&o.push(new b(s._id).setValue(s)))}for(var l=0;l<n.length;l++){for(var u=n[l],d=!1,h=0;h<t.length;h++){var g=t[h];if(u.cid===g.cid){d=!0;break}}d||o.push(u)}B.dispatch({type:"SET_CHAT_LIST_CM",payload:{chat:o}})}})).catch((function(e){console.log("CATCH: Error"),console.log(e)}))},te=function(e,t){B.dispatch({type:"MSG_ACK_ACTION",payload:{message:e,status:t}})},ne=function(e,t,n){B.dispatch({type:"MSGS_ACK_ACTION",payload:{messages:e,cid:t,status:n}})},oe=function(e){B.dispatch({type:"USER_CHAT_DATA_COLLECTOR",payload:{message:e}})},ae=function(e){B.dispatch({type:"USER_CHAT_SENT_DATA_COLLECTOR",payload:{message:e}})},se=function(){},ie=function(){},ce=function(e){Y.connect(e,oe,te,ne,se,ie),B.dispatch({type:"HANDLE_REMOVE_CHAT",payload:{cid:e}})},re=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];"single"===e.chatType?Y.send(e,t):Y.sendGroupMessage(e,n),ae(e)},le=function(e){Z.push((new Q).connect(e,oe,te,ne))},ue=n(16),de=function(e){return function(t){t({type:"SET_USER",payload:{user:e}})}},he=(n(132),function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(c.a)(this,n);for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).state={messageBody:"",file:null,chat:[]},e.handleSendMesage=function(t,n,o,a,s){e.setState({messageBody:""});var i=null,c=[];if("group"===a){for(var r=0;r<s.length;r++){var l=s[r];c.push(l._id)}i=(new h).setAttributes(o,t,e.state.messageBody,n).setAsGroupMessage()}else i=(new h).setAttributes(o,t,e.state.messageBody);re(i,n,c)},e.handleSendImage=function(t,n,o){console.log(e.state.file);var a=new FileReader;a.readAsDataURL(e.state.file),a.onload=function(e){console.log("onload"),console.log(e),console.log(a.result),a.result},a.onerror=function(e){console.log("ERROR ON FILE "),console.log(e)}},e}return Object(r.a)(n,[{key:"render",value:function(){var e=this,t=this.props.userChat.filter((function(e){return!0===e.selected}))[0];return!!t&&(t.chatStatus!==R.USER_CHAT_FOUND?a.a.createElement("div",null,a.a.createElement("button",{onClick:function(){return n=e.props.user._id,o=t.user._id,void K.a.post("http://localhost:5000/API/user/chat/initialize-chat",{userId:n,friendId:o}).then((function(e){e.data.success?B.dispatch({type:"INITIALIZE_CHAT_BETWEEN_CM",payload:{friend:e.data.friend,chat:e.data.chat}}):(console.log("INIT CHAT SUCCESS: FALSE"),console.log(e.data.error))})).catch((function(e){console.log("CATCH: INITIALIZE CHAT"),console.log(e)}));var n,o}},"Initialize Chat with ",t.title)):a.a.createElement("div",{style:{width:"100%",height:"100%"}},a.a.createElement("div",{style:{width:"100%",height:100,backgroundColor:"#5BBC93"}},a.a.createElement("span",{style:{fontSize:30,color:"white",marginLeft:20}},t.title)),a.a.createElement("div",{style:{height:550,width:"100%",overflowY:"scroll",backgroundColor:"white"}},t.messages.map((function(t,n){return a.a.createElement("div",{key:n},a.a.createElement(g,{message:t,cid:e.props.user._id}),a.a.createElement("br",null))}))),a.a.createElement("div",{style:{width:"100%",height:70,backgroundColor:"white"}},a.a.createElement("input",{onFocus:function(){return function(e,t){var n=B.getState().ChatReducer.Chat,o=n.findIndex((function(t){return t.cid===e}));if(-1===o&&(o=n.findIndex((function(e){return e._id===t}))),o>=0){var a=[];if("group"===n[o].chatType){for(var s=n[o].messages.filter((function(t){return(t.status===h.SENDING||t.status===h.RECIEVED||t.status===h.SENT)&&t.from===e})),i=0;i<s.length;i++)s[i].status=h.SEEN,s[i].seenTimeDate=Date.now();for(var c=0;c<n[o].users.length;c++){var r=n[o].users[c];a.push(r._id)}Y.markSeenGroupMessage(s,e,t,a)}else{for(var l=n[o].messages.filter((function(t){return(t.status===h.SENDING||t.status===h.RECIEVED||t.status===h.SENT)&&t.from===e})),u=0;u<l.length;u++)l[u].status=h.SEEN,l[u].seenTimeDate=Date.now();Y.markSeen(l,e,t,a)}}}(t.cid,t._id)},value:this.state.messageBody,onChange:function(t){return e.setState({messageBody:t.target.value})},style:{borderRadius:30,padding:5,color:"#5BBC93",width:"70%",height:55,fontSize:25},placeholder:"frient name"}),a.a.createElement("button",{onClick:function(){return e.handleSendMesage(t.cid,t._id,e.props.user._id,t.chatType,t.users)},style:{backgroundColor:"#5BBC93",border:"2px solid white",borderRadius:30,width:"20%",height:55}},a.a.createElement("span",{style:{color:"white",fontSize:18}},"SEND")),a.a.createElement("input",{onChange:function(t){return e.setState({file:t.target.files[0]})},type:"file"}))))}}]),n}(a.a.Component)),ge=Object(ue.b)(null,{setUser:de})(he),Ee=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(c.a)(this,n);for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).state={},e}return Object(r.a)(n,[{key:"render",value:function(){var e=this.props.singleChat,t=e.messages.length>0&&e.messages[e.messages.length-1],n=e.messages.unseenCount;return a.a.createElement("div",{onClick:function(){return t=e.cid,void B.dispatch({type:"USER_CHAT_HANDLE_SELECTD",payload:{cid:t}});var t},style:{cursor:"pointer",width:"100%",height:100,backgroundColor:e.selected?"#EBEBEB":"white",borderBottom:"2px solid #f0f0f0"}},a.a.createElement("div",{align:"center",style:{width:"30%",height:"100%",float:"left",borderRadius:50,border:"1px solid #f0f0f0"}},n>0&&a.a.createElement("div",{align:"center",style:{marginTop:"40%",zIndex:99,backgroundColor:"#5BBC93",borderRadius:50,width:"25px",height:"25px"}},n)),a.a.createElement("div",{style:{width:"65%",float:"right"}},a.a.createElement("span",{style:{fontSize:25,width:"100%",textAlign:"center"}},e.title),a.a.createElement("br",null),a.a.createElement("span",{style:{textOverflow:"ellipsis"}},!!t&&("TEXT"===t.type?t.body:"IMAGE"))))}}]),n}(o.Component),Ce=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this)).connectUser=function(){var t;""!==e.state.myId&&""!==e.state.friendId?(console.log("STATE"),console.log(e.state),ce(e.state.myId),t=function(){e.setState({isConnected:!0})},Y.onConnectEmitter=t):alert("Invalid USER or FRIEND Id")},e.handleInitiateCall=function(){var t;t=e.state.friendId,Y.initializeSignaling(t)},e.endCall=function(){Y.destroyRTCConnection(),Y.endCallSignal()},e.answerCall=function(){console.log("ANSWER CALL"),Y.acceptCall(),e.setState({callStatus:y.ACCEPTED})},e.setSelected=function(t){for(var n=Object(E.a)(e.state.configs),o=0;o<n.length;o++){n[o].id===t?n[o].selected=!0:n[o].selected=!1}e.setState({configs:n})},e.getSelected=function(){return e.state.configs.filter((function(e){return!0===e.selected}))[0].value},e.state={localStream:null,peerStream:null,isConnected:!1,myId:"",friendId:"",callRunning:!1,isMute:!1,connectionState:"",callStatus:-1,configs:[{id:1,selected:!1,value:{iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"turn:numb.viagenie.ca",username:"ata.mirza40@gmail.com",credential:"ataMirza12345_"}]}},{id:2,selected:!1,value:{iceServers:[{url:"stun:stun.l.google.com:19302"}]}},{id:3,selected:!0,value:{iceServers:[{url:"stun:stun.l.google.com:19302"},{urls:"turn:turn.msgsafe.io:443?transport=tcp",username:"a9a2b514",credential:"00163e7826d6"}]}},{id:4,selected:!1,value:{iceServers:[{url:"stun:stun.l.google.com:19302"},{url:"turn:192.158.29.39:3478?transport=udp",credential:"JZEOEt2V3Qb0y27GRntt2u2PAYA=",username:"28224511:1379330808"}]}},{id:5,selected:!1,value:{iceServers:[{url:"stun:stun.l.google.com:19302"},{urls:["turn:13.250.13.83:3478?transport=udp"],username:"YzYNCouZM1mhqhmseWk6",credential:"YzYNCouZM1mhqhmseWk6"}]}},{id:6,selected:!1,value:{iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"turn:numb.viagenie.ca",username:"ata.mirza40@gmail.com",credential:"ataMirza12345_"}],iceTransports:"relay"}},{id:7,selected:!1,value:{iceServers:[{url:"stun:stun.l.google.com:19302"},{urls:"turn:turn.msgsafe.io:443?transport=tcp",username:"a9a2b514",credential:"00163e7826d6"}]}},{id:8,selected:!1,value:{iceServers:[{urls:"turn:turn.msgsafe.io:443?transport=tcp",username:"a9a2b514",credential:"00163e7826d6"}]}}]},e.peerConnectionA=null,e}return Object(r.a)(n,[{key:"componentDidMount",value:function(){var e;e=this,Y.setChatContext(e)}},{key:"render",value:function(){var e=this;switch(this.myStream&&(this.myStream.srcObject=this.state.localStream,this.myStream.volume=0,this.myStream.muted=!0,this.friendStream.srcObject=this.state.peerStream),this.state.callStatus){case y.RINGING_REQUEST:return a.a.createElement("div",{style:{backgroundColor:"#363442",width:"100%",height:window.innerHeight}},a.a.createElement("div",{align:"center",style:{alignSelf:"center"}},a.a.createElement("div",{style:{height:200}}),a.a.createElement("span",{style:{color:"white",fontSize:30}},"Ringing..."),a.a.createElement("br",null),a.a.createElement("div",{style:{height:50}}),a.a.createElement("button",{onClick:function(){return e.answerCall()},style:{width:100,height:50,backgroundColor:"green",border:"0px",borderRadius:50,color:"white",fontSize:20}},"Accept"),a.a.createElement("button",{onClick:function(){return e.endCall()},style:{width:100,height:50,backgroundColor:"red",border:"0px",borderRadius:50,color:"white",fontSize:20}},"CANCEL")));case y.RINGING:return a.a.createElement("div",{style:{backgroundColor:"#363442",width:"100%",height:window.innerHeight}},a.a.createElement("div",{align:"center",style:{alignSelf:"center"}},a.a.createElement("div",{style:{height:200}}),a.a.createElement("span",{style:{color:"white",fontSize:30}},"Ringing..."),a.a.createElement("br",null),a.a.createElement("div",{style:{height:50}}),a.a.createElement("button",{onClick:function(){return e.endCall()},style:{width:100,height:50,backgroundColor:"red",border:"0px",borderRadius:50,color:"white",fontSize:20}},"CANCEL")));case y.ACCEPTED:return a.a.createElement("div",{style:{backgroundColor:"#363442",width:"100%",height:window.innerHeight}},a.a.createElement("video",{ref:function(t){return e.friendStream=t},style:{width:"100%",height:window.innerHeight,backfaceVisibility:"visible"},autoPlay:!0}),a.a.createElement("video",{ref:function(t){return e.myStream=t},style:{width:200,zIndex:999,position:"absolute",bottom:10,right:10,height:200,backfaceVisibility:"visible"}}),a.a.createElement("button",{onClick:function(){return e.endCall()},align:"center",style:{position:"absolute",backgroundColor:"red",width:60,height:60,color:"white",borderRadius:50,border:"0px",bottom:30,left:window.innerWidth/2-10}},"END"));default:return a.a.createElement("div",{className:"App"},a.a.createElement("h1",{align:"center"},"CHAT APPLICATIONS"),a.a.createElement("div",{style:{height:100}}),this.state.isConnected?a.a.createElement(a.a.Fragment,null,a.a.createElement("h2",{align:"center"},"ME: ".concat(this.state.myId,", FRIEND: ").concat(this.state.friendId)),a.a.createElement("div",{style:{paddingLeft:"32%",width:"100%"}},a.a.createElement("button",{style:{width:300,height:50,borderRadius:30,margin:"auto"},onClick:function(){return e.handleInitiateCall()}},"START CALL"))):a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{style:{width:"100%",paddingLeft:"34%"}},a.a.createElement("span",{style:{fontSize:30}},"Me:"),a.a.createElement("br",null),a.a.createElement("input",{style:{borderRadius:20,padding:10,fontSize:20},value:this.state.myId,onChange:function(t){return e.setState({myId:t.target.value})},type:"text"})),a.a.createElement("div",{style:{width:"100%",paddingLeft:"34%"}},a.a.createElement("span",{style:{fontSize:30}},"Friend:"),a.a.createElement("br",null),a.a.createElement("input",{style:{borderRadius:20,padding:10,fontSize:20},value:this.state.friendId,onChange:function(t){return e.setState({friendId:t.target.value})},type:"text"})),a.a.createElement("div",{style:{height:30}}),a.a.createElement("div",{style:{paddingLeft:"32%",width:"100%"}},a.a.createElement("button",{style:{width:300,height:50,borderRadius:30,margin:"auto"},onClick:function(){return e.connectUser()}},"Connect"))))}}}]),n}(a.a.Component),fe=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(c.a)(this,n);for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).state={calling:!0,loginError:"",phoneNumber:""},e.handleConnect=function(t){ce(t.cid),ee(t.cid),e.props.setUser(t.user)},e.loginUser=function(t){if(""===t)return e.setState({loginError:"Enter PhoneNumber"}),!1;K.a.post(W+"/API/user/auth/login",{phoneNumber:t}).then((function(t){t.data.success?(ee(t.data.user._id),e.props.setUser(t.data.user),e.setState({loginError:"Login Success!"})):e.setState({loginError:t.data.msg})})).catch((function(t){console.log("CATCH: NETWORK ERROR"),e.setState({loginError:"CATCH: NETWORK ERROR"}),console.log(t)}))},e}return Object(r.a)(n,[{key:"componentDidMount",value:function(){""!==this.props.user._id?ce(this.props.user._id):$()}},{key:"render",value:function(){var e=this;return this.state.calling?a.a.createElement(Ce,null):a.a.createElement("div",{key:0,style:{width:"100%",height:"100%"}},""!==this.props.user._id?a.a.createElement("div",{key:1,style:{width:"100%",height:700}},a.a.createElement("div",{key:2,style:{width:"20%",height:"100%",backgroundColor:"white",float:"left"}},a.a.createElement("div",{key:3,style:{width:"100%",height:100,textAlign:"center"}},a.a.createElement("span",{key:4,style:{fontSize:25,color:"#5BBC93"}},this.props.user.username),a.a.createElement("button",{onClick:function(){B.dispatch({type:"LOGOUT"}),$()},style:{borderRadius:10}},"logout")),this.props.userChat.map((function(e,t){return a.a.createElement(Ee,{key:t,singleChat:e})}))),a.a.createElement("div",{key:5,style:{width:"80%",float:"right"}},a.a.createElement(ge,{key:6,user:this.props.user,userChat:this.props.userChat,onConnect:this.handleConnectSocket,onSendMessage:this.handleSendMessage}))):a.a.createElement("div",{key:7,align:"center",style:{margin:"auto",marginTop:100}},a.a.createElement("input",{type:"text",placeholder:"phonenumber",onChange:function(t){return e.setState({phoneNumber:t.target.value})},value:this.state.phoneNumber}),a.a.createElement("button",{onClick:function(){return e.loginUser(e.state.phoneNumber)}}," LOGIN "),a.a.createElement("span",null,this.state.loginError)))}}]),n}(a.a.Component),me=Object(ue.b)((function(e){return{userChat:e.ChatReducer.Chat,user:e.AuthReducer.user}}),{setUser:de})(fe);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(ue.a,{store:B},a.a.createElement(me,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},74:function(e,t,n){e.exports=n(157)},79:function(e,t,n){}},[[74,1,2]]]);
//# sourceMappingURL=main.28883842.chunk.js.map